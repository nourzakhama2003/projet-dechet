<div class="flex h-screen bg-gray-50 font-sans overflow-hidden">
  <!-- Sidebar -->
  @if(sidebarOpen) {
  <aside
    class="w-64 bg-white border-r border-gray-200 flex flex-col shadow-sm z-10"
  >
    <div class="p-6 flex items-center justify-center border-b border-gray-100">
      <h1
        class="text-2xl font-bold bg-clip-text text-transparent bg-blue-500 tracking-tight"
      >
        Admin Panel
      </h1>
    </div>

    <nav class="flex-1 px-4 py-6 space-y-2 overflow-y-auto custom-scrollbar">
      <button
        (click)="setActiveTab('users')"
        [class.bg-gray-100]="activeTab === 'users'"
        [class.text-gray-700]="activeTab === 'users'"
        class="w-full flex items-center px-4 py-3 text-gray-600 rounded-xl transition-all duration-200 hover:bg-gray-50 hover:text-gray-700 group"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-3 transition-colors duration-200"
          [class.text-gray-700]="activeTab === 'users'"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"
          />
        </svg>
        <span class="font-medium">Users</span>
      </button>

      <button
        (click)="setActiveTab('containers')"
        [class.bg-gray-100]="activeTab === 'containers'"
        [class.text-gray-700]="activeTab === 'containers'"
        class="w-full flex items-center px-4 py-3 text-gray-600 rounded-xl transition-all duration-200 hover:bg-gray-50 hover:text-gray-700 group"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-3 transition-colors duration-200"
          [class.text-gray-700]="activeTab === 'containers'"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
          />
        </svg>
        <span class="font-medium">Containers</span>
      </button>

      <button
        (click)="setActiveTab('pickuppoints')"
        [class.bg-gray-100]="activeTab === 'pickuppoints'"
        [class.text-gray-700]="activeTab === 'pickuppoints'"
        class="w-full flex items-center px-4 py-3 text-gray-600 rounded-xl transition-all duration-200 hover:bg-gray-50 hover:text-gray-700 group"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-3 transition-colors duration-200"
          [class.text-gray-700]="activeTab === 'pickuppoints'"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
          />
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
          />
        </svg>
        <span class="font-medium">Pickup Points</span>
      </button>

      <button
        (click)="setActiveTab('vehicles')"
        [class.bg-gray-100]="activeTab === 'vehicles'"
        [class.text-gray-700]="activeTab === 'vehicles'"
        class="w-full flex items-center px-4 py-3 text-gray-600 rounded-xl transition-all duration-200 hover:bg-gray-50 hover:text-gray-700 group"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-3 transition-colors duration-200"
          [class.text-gray-700]="activeTab === 'vehicles'"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"
          />
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"
          />
        </svg>
        <span class="font-medium">Vehicles</span>
      </button>

      <button
        (click)="setActiveTab('incidents')"
        [class.bg-gray-100]="activeTab === 'incidents'"
        [class.text-gray-700]="activeTab === 'incidents'"
        class="w-full flex items-center px-4 py-3 text-gray-600 rounded-xl transition-all duration-200 hover:bg-gray-50 hover:text-gray-700 group"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-3 transition-colors duration-200"
          [class.text-gray-700]="activeTab === 'incidents'"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
          />
        </svg>
        <span class="font-medium">Incidents</span>
      </button>

      <button
        (click)="setActiveTab('notifications')"
        [class.bg-gray-100]="activeTab === 'notifications'"
        [class.text-gray-700]="activeTab === 'notifications'"
        class="w-full flex items-center px-4 py-3 text-gray-600 rounded-xl transition-all duration-200 hover:bg-gray-50 hover:text-gray-700 group"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-3 transition-colors duration-200"
          [class.text-gray-700]="activeTab === 'notifications'"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"
          />
        </svg>
        <span class="font-medium">Notifications</span>
      </button>

      <button
        (click)="setActiveTab('routes')"
        [class.bg-gray-100]="activeTab === 'routes'"
        [class.text-gray-700]="activeTab === 'routes'"
        class="w-full flex items-center px-4 py-3 text-gray-600 rounded-xl transition-all duration-200 hover:bg-gray-50 hover:text-gray-700 group"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-3 transition-colors duration-200"
          [class.text-gray-700]="activeTab === 'routes'"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 9m0 11V9m0 0L9 7"
          />
        </svg>
        <span class="font-medium">Routes</span>
      </button>
    </nav>

    <div class="p-4 border-t border-gray-100">
      <div class="flex items-center p-3 bg-gray-50 rounded-lg">
        <div
          class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center text-green-600 font-bold text-xs"
        >
          AD
        </div>
        <div class="ml-3">
          <p class="text-sm font-medium text-gray-700">Admin User</p>
          <p class="text-xs text-gray-500">admin@example.com</p>
        </div>
      </div>

    </div>
  </aside>}

  <!-- Main Content -->
  <main class="flex-1 overflow-y-auto bg-gray-50 p-8">
    <header class="mb-8 flex justify-between items-center">
      <div>
        <h2 class="text-3xl font-bold text-gray-800">
          <ng-container [ngSwitch]="activeTab">
            <span *ngSwitchCase="'users'">User Management</span>
            <span *ngSwitchCase="'containers'">Container Inventory</span>
            <span *ngSwitchCase="'pickuppoints'">Pickup Points Map</span>
            <span *ngSwitchCase="'vehicles'">Vehicle Fleet</span>
            <span *ngSwitchCase="'incidents'">Incident Reports</span>
            <span *ngSwitchCase="'notifications'">System Notifications</span>
            <span *ngSwitchCase="'routes'">Collection Routes</span>
          </ng-container>
        </h2>
        <p class="text-gray-500 mt-1">Manage your resources efficiently.</p>
      </div>
      <!-- Add Action Button (Optional) -->
       <div class="flex justify-between gap-6">    <button
        *ngIf="activeTab !== 'pickuppoints' && activeTab !== 'routes'"
        class="px-5 py-2.5 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg shadow-md transition-colors duration-200 flex items-center"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-2"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 4v16m8-8H4"
          />
        </svg>
        Add New
      </button>
   <button class="p-3 m-2 rounded-full border border-black bg-slate-50" (click)="show()">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
       viewBox="0 0 24 24" fill="none" stroke="currentColor"
       stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
       class="lucide lucide-eye">
    <path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"/>
    <circle cx="12" cy="12" r="3"/>
  </svg>
</button>
</div>
  

    </header>

    <!-- Loading State -->
    <div *ngIf="loading" class="flex justify-center items-center h-64">
      <div
        class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"
      ></div>
    </div>

    <!-- Users View -->
    <div
      *ngIf="activeTab === 'users' && !loading"
      class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"
    >
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead>
            <tr
              class="bg-gray-50 border-b border-gray-100 text-xs uppercase text-gray-500 tracking-wider font-semibold"
            >
              <th class="px-6 py-4">User</th>
              <th class="px-6 py-4">Role</th>
              <th class="px-6 py-4">Email</th>
              <th class="px-6 py-4">Status</th>
              <th class="px-6 py-4 text-right">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-50">
            <tr
              *ngFor="let user of users"
              class="hover:bg-gray-50 transition-colors duration-150 group"
            >
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <div
                    class="h-10 w-10 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center text-blue-600 font-bold text-sm shadow-sm"
                  >
                    {{ user.firstName?.charAt(0) || "U"
                    }}{{ user.lastName?.charAt(0) || "" }}
                  </div>
                  <div class="ml-4">
                    <div class="text-sm font-medium text-gray-900">
                      {{ user.firstName }} {{ user.lastName }}
                    </div>
                    <div class="text-xs text-gray-500">
                      @{{ user.username }}
                    </div>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-50 text-blue-700 border border-blue-100"
                >
                  {{ user.role || "User" }}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {{ user.email }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"
                >
                  Active
                </span>
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
              >
                <button
                  class="text-gray-400 hover:text-blue-600 transition-colors duration-200 mr-3"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                    />
                  </svg>
                </button>
                <button
                  class="text-gray-400 hover:text-red-600 transition-colors duration-200"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                    />
                  </svg>
                </button>
              </td>
            </tr>
            <tr *ngIf="users.length === 0" class="bg-white">
              <td colspan="5" class="px-6 py-12 text-center text-gray-500">
                No users found.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Containers View -->
    <div
      *ngIf="activeTab === 'containers' && !loading"
      class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"
    >
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead>
            <tr
              class="bg-gray-50 border-b border-gray-100 text-xs uppercase text-gray-500 tracking-wider font-semibold"
            >
              <th class="px-6 py-4">Code</th>
              <th class="px-6 py-4">Type</th>
              <th class="px-6 py-4">Fill Level</th>
              <th class="px-6 py-4">Status</th>
              <th class="px-6 py-4 text-right">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-50">
            <tr
              *ngFor="let container of containers"
              class="hover:bg-gray-50 transition-colors duration-150"
            >
              <td
                class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"
              >
                #{{ container.code || container.id?.substring(0, 8) }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full"
                  [ngClass]="{
                    'bg-yellow-50 text-yellow-700':
                      container.type === 'PLASTIC',
                    'bg-blue-50 text-blue-700': container.type === 'PAPER',
                    'bg-gray-100 text-gray-700': !container.type
                  }"
                >
                  {{ container.type || "General" }}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                <div class="flex items-center">
                  <div
                    class="w-24 h-2 bg-gray-200 rounded-full overflow-hidden mr-3"
                  >
                    <div
                      class="h-full rounded-full"
                      [style.width.%]="
                        (container.fillLevel / container.capacity) * 100
                      "
                      [ngClass]="{
                        'bg-green-500':
                          container.fillLevel / container.capacity < 0.5,
                        'bg-yellow-500':
                          container.fillLevel / container.capacity >= 0.5 &&
                          container.fillLevel / container.capacity < 0.8,
                        'bg-red-500':
                          container.fillLevel / container.capacity >= 0.8
                      }"
                    ></div>
                  </div>
                  <span class="text-xs font-medium"
                    >{{
                      (container.fillLevel / container.capacity) * 100
                        | number : "1.0-0"
                    }}%</span
                  >
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                  [ngClass]="{
                    'bg-green-100 text-green-800':
                      container.containerStatus !== 'non_functional',
                    'bg-red-100 text-red-800':
                      container.containerStatus === 'non_functional'
                  }"
                >
                  {{
                    container.containerStatus === "non_functional"
                      ? "Damaged"
                      : "Active"
                  }}
                </span>
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
              >
                <button
                  class="text-gray-400 hover:text-blue-600 transition-colors duration-200 mr-3"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"
                    />
                  </svg>
                </button>
                <button
                  class="text-gray-400 hover:text-red-600 transition-colors duration-200"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                    />
                  </svg>
                </button>
              </td>
            </tr>
            <tr *ngIf="containers.length === 0" class="bg-white">
              <td colspan="5" class="px-6 py-12 text-center text-gray-500">
                No containers found.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Pickup Points View -->
    <div *ngIf="activeTab === 'pickuppoints'" class="flex flex-col space-y-6">
      <!-- Map Section -->
      <div
        class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"
      >
        <div
          class="p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50"
        >
          <h3 class="font-semibold text-gray-700 flex items-center">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5 mr-2 text-green-600"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0121 18.382V7.618a1 1 0 01-.806-.984A10.001 10.001 0 018.022 16.697L9 20zm3-13v6m0 0l3-3m-3 3l-3-3"
              />
            </svg>
            Interactive Map
          </h3>
          <div class="flex items-center gap-3">
            <button
              *ngIf="showMap && mapComponent && hasOptimizedRoute()"
              (click)="createRouteFromMap()"
              [disabled]="
                mapComponent.isDuplicateRoute ||
                mapComponent.duplicateCheckLoading
              "
              [class.opacity-50]="
                mapComponent.isDuplicateRoute ||
                mapComponent.duplicateCheckLoading
              "
              [class.cursor-not-allowed]="
                mapComponent.isDuplicateRoute ||
                mapComponent.duplicateCheckLoading
              "
              class="px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-all flex items-center gap-2"
            >
              <svg
                *ngIf="!mapComponent.duplicateCheckLoading"
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 13l4 4L19 7"
                />
              </svg>
              <svg
                *ngIf="mapComponent.duplicateCheckLoading"
                class="animate-spin h-4 w-4 text-white"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
              >
                <circle
                  class="opacity-25"
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="currentColor"
                  stroke-width="4"
                ></circle>
                <path
                  class="opacity-75"
                  fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                ></path>
              </svg>
              {{
                mapComponent.isDuplicateRoute
                  ? "Route Exists"
                  : mapComponent.duplicateCheckLoading
                  ? "Checking..."
                  : "Create Route"
              }}
            </button>
            <button
              (click)="toggleMap()"
              class="text-sm font-medium text-green-600 hover:text-green-800 transition-colors focus:outline-none"
            >
              {{ showMap ? "Hide Map" : "Show Map" }}
            </button>
          </div>
        </div>
        <div
          *ngIf="showMap"
          class="h-[500px] w-full transition-all duration-300 ease-in-out"
        >
          <app-map></app-map>
        </div>
      </div>

      <!-- Pickup Points List -->
      <div
        class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"
      >
        <div class="p-6 border-b border-gray-100">
          <h3 class="text-lg font-bold text-gray-800">
            Pickup Points & Containers
          </h3>
          <p class="text-sm text-gray-500 mt-1">
            List of all collection points and their current status.
          </p>
        </div>

        <div class="overflow-x-auto">
          <table class="w-full text-left border-collapse">
            <thead>
              <tr
                class="bg-gray-50 border-b border-gray-100 text-xs uppercase text-gray-500 tracking-wider font-semibold"
              >
                <th class="px-6 py-4">Location</th>
                <th class="px-6 py-4">Address</th>
                <th class="px-6 py-4">Containers</th>
                <th class="px-6 py-4 text-right">Actions</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-50">
              <tr
                *ngFor="let point of pickupPoints"
                class="hover:bg-gray-50 transition-colors duration-150"
              >
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div
                      class="h-8 w-8 rounded-full bg-green-100 flex items-center justify-center text-green-600 shadow-sm"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="h-4 w-4"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                        />
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                        />
                      </svg>
                    </div>
                    <div class="ml-3">
                      <div class="text-sm font-medium text-gray-900">
                        Point #{{ point.id?.substring(0, 6) }}
                      </div>
                      <div class="text-xs text-gray-500">
                        Lat: {{ point.locationLatitude | number : "1.4-4" }},
                        Lng: {{ point.locationLongitude | number : "1.4-4" }}
                      </div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                  {{ point.address || "No address provided" }}
                </td>
                <td class="px-6 py-4">
                  <div class="flex flex-col space-y-2">
                    <div
                      *ngFor="let container of point.containers"
                      class="flex items-center text-xs"
                    >
                      <span
                        class="w-2 h-2 rounded-full mr-2"
                        [ngClass]="{
                          'bg-green-500':
                            container.fillLevel / container.capacity < 0.5,
                          'bg-yellow-500':
                            container.fillLevel / container.capacity >= 0.5 &&
                            container.fillLevel / container.capacity < 0.8,
                          'bg-red-500':
                            container.fillLevel / container.capacity >= 0.8 ||
                            container.containerStatus === 'non_functional'
                        }"
                      >
                      </span>
                      <span class="font-medium text-gray-700 mr-1"
                        >{{ container.type || "Bin" }}:</span
                      >
                      <span class="text-gray-500"
                        >{{
                          (container.fillLevel / container.capacity) * 100
                            | number : "1.0-0"
                        }}%</span
                      >
                      <span
                        *ngIf="container.containerStatus === 'non_functional'"
                        class="ml-2 px-1.5 py-0.5 bg-red-100 text-red-800 rounded text-[10px] font-bold"
                        >DAMAGED</span
                      >
                    </div>
                    <div
                      *ngIf="!point.containers || point.containers.length === 0"
                      class="text-xs text-gray-400 italic"
                    >
                      No containers
                    </div>
                  </div>
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
                >
                  <button
                    class="text-blue-600 hover:text-blue-900 text-xs font-semibold"
                  >
                    Edit
                  </button>
                </td>
              </tr>
              <tr *ngIf="pickupPoints.length === 0" class="bg-white">
                <td colspan="4" class="px-6 py-12 text-center text-gray-500">
                  No pickup points found.
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Vehicles View -->
    <div
      *ngIf="activeTab === 'vehicles' && !loading"
      class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"
    >
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead>
            <tr
              class="bg-gray-50 border-b border-gray-100 text-xs uppercase text-gray-500 tracking-wider font-semibold"
            >
              <th class="px-6 py-4">Matricule</th>
              <th class="px-6 py-4">Type</th>
              <th class="px-6 py-4">Capacity (kg)</th>
              <th class="px-6 py-4">Status</th>
              <th class="px-6 py-4">Assigned Users</th>
              <th class="px-6 py-4 text-right">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-50">
            <tr
              *ngFor="let vehicle of vehicles"
              class="hover:bg-gray-50 transition-colors duration-150"
            >
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <div
                    class="h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 shadow-sm"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-5 w-5"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"
                      />
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"
                      />
                    </svg>
                  </div>
                  <div class="ml-3">
                    <div class="text-sm font-medium text-gray-900">
                      {{ vehicle.matricul }}
                    </div>
                    <div class="text-xs text-gray-500">
                      #{{ vehicle.id?.substring(0, 8) }}
                    </div>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full"
                  [ngClass]="{
                    'bg-purple-50 text-purple-700 border border-purple-100':
                      vehicle.vehiculeType === 'camion',
                    'bg-cyan-50 text-cyan-700 border border-cyan-100':
                      vehicle.vehiculeType === 'car'
                  }"
                >
                  {{ vehicle.vehiculeType === "camion" ? "Truck" : "Car" }}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {{ vehicle.capacity | number : "1.0-0" }} kg
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                  [ngClass]="{
                    'bg-green-100 text-green-800':
                      vehicle.vehiculeStatus === 'fonctionnel',
                    'bg-red-100 text-red-800':
                      vehicle.vehiculeStatus === 'en_maintenance'
                  }"
                >
                  {{
                    vehicle.vehiculeStatus === "fonctionnel"
                      ? "Operational"
                      : "Maintenance"
                  }}
                </span>
              </td>
              <td class="px-6 py-4">
                <div
                  *ngIf="vehicle.users && vehicle.users.length > 0"
                  class="flex flex-col space-y-1"
                >
                  <div
                    *ngFor="let user of vehicle.users"
                    class="flex items-center text-xs"
                  >
                    <div
                      class="h-6 w-6 rounded-full bg-gradient-to-br from-green-100 to-green-200 flex items-center justify-center text-green-600 font-bold text-[10px] shadow-sm mr-2"
                    >
                      {{ user.firstName?.charAt(0) || "U"
                      }}{{ user.lastName?.charAt(0) || "" }}
                    </div>
                    <span class="font-medium text-gray-700"
                      >{{ user.firstName }} {{ user.lastName }}</span
                    >
                    <span
                      class="ml-2 px-1.5 py-0.5 bg-blue-50 text-blue-700 rounded text-[10px] font-semibold"
                      >{{ user.role }}</span
                    >
                  </div>
                </div>
                <div
                  *ngIf="!vehicle.users || vehicle.users.length === 0"
                  class="text-xs text-gray-400 italic"
                >
                  No users assigned
                </div>
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
              >
                <button
                  class="text-gray-400 hover:text-blue-600 transition-colors duration-200 mr-3"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                    />
                  </svg>
                </button>
                <button
                  class="text-gray-400 hover:text-red-600 transition-colors duration-200"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                    />
                  </svg>
                </button>
              </td>
            </tr>
            <tr *ngIf="vehicles.length === 0" class="bg-white">
              <td colspan="6" class="px-6 py-12 text-center text-gray-500">
                No vehicles found.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Incidents View -->
    <div
      *ngIf="activeTab === 'incidents' && !loading"
      class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"
    >
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead>
            <tr
              class="bg-gray-50 border-b border-gray-100 text-xs uppercase text-gray-500 tracking-wider font-semibold"
            >
              <th class="px-6 py-4">Incident ID</th>
              <th class="px-6 py-4">Description</th>
              <th class="px-6 py-4">Date</th>
              <th class="px-6 py-4">Status</th>
              <th class="px-6 py-4 text-right">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-50">
            <tr
              *ngFor="let incident of incidents"
              class="hover:bg-gray-50 transition-colors duration-150"
            >
              <td
                class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"
              >
                #{{ incident.id?.substring(0, 8) }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {{ incident.description || "No description" }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {{ incident.date | date : "mediumDate" }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                  [ngClass]="{
                    'bg-yellow-100 text-yellow-800':
                      incident.status === 'pending',
                    'bg-green-100 text-green-800':
                      incident.status === 'resolved'
                  }"
                >
                  {{ incident.status || "Pending" }}
                </span>
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
              >
                <button
                  class="text-gray-400 hover:text-blue-600 transition-colors duration-200 mr-3"
                >
                  View
                </button>
                <button
                  class="text-gray-400 hover:text-green-600 transition-colors duration-200"
                >
                  Resolve
                </button>
              </td>
            </tr>
            <tr *ngIf="incidents.length === 0" class="bg-white">
              <td colspan="5" class="px-6 py-12 text-center text-gray-500">
                No incidents found.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Notifications View -->
    <div
      *ngIf="activeTab === 'notifications' && !loading"
      class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"
    >
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead>
            <tr
              class="bg-gray-50 border-b border-gray-100 text-xs uppercase text-gray-500 tracking-wider font-semibold"
            >
              <th class="px-6 py-4">Notification</th>
              <th class="px-6 py-4">Type</th>
              <th class="px-6 py-4">Recipient</th>
              <th class="px-6 py-4">Date</th>
              <th class="px-6 py-4 text-right">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-50">
            <tr
              *ngFor="let notification of notifications"
              class="hover:bg-gray-50 transition-colors duration-150"
            >
              <td class="px-6 py-4">
                <div class="flex items-center">
                  <div
                    class="h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 shadow-sm"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-5 w-5"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"
                      />
                    </svg>
                  </div>
                  <div class="ml-3">
                    <div class="text-sm font-medium text-gray-900">
                      {{ notification.subject }}
                    </div>
                    <div class="text-xs text-gray-500 line-clamp-2">
                      {{ notification.body }}
                    </div>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full"
                  [ngClass]="{
                    'bg-red-50 text-red-700 border border-red-100':
                      notification.notificationType === 'incident_notification',
                    'bg-orange-50 text-orange-700 border border-orange-100':
                      notification.notificationType === 'capacity_notification'
                  }"
                >
                  {{
                    notification.notificationType === "incident_notification"
                      ? "Incident"
                      : "Capacity"
                  }}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {{ notification.recipient }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {{ notification.date | date : "short" }}
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
              >
                <button
                  class="text-gray-400 hover:text-blue-600 transition-colors duration-200 mr-3"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                    />
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                    />
                  </svg>
                </button>
                <button
                  class="text-gray-400 hover:text-red-600 transition-colors duration-200"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                    />
                  </svg>
                </button>
              </td>
            </tr>
            <tr *ngIf="notifications.length === 0" class="bg-white">
              <td colspan="5" class="px-6 py-12 text-center text-gray-500">
                No notifications found.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Routes View -->
    <div
      *ngIf="activeTab === 'routes' && !loading"
      class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"
    >
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead>
            <tr
              class="bg-gray-50 border-b border-gray-100 text-xs uppercase text-gray-500 tracking-wider font-semibold"
            >
              <th class="px-6 py-4">Route ID</th>
              <th class="px-6 py-4">Date</th>
              <th class="px-6 py-4">Vehicle</th>
              <th class="px-6 py-4">Pickup Points</th>
              <th class="px-6 py-4">Distance</th>
              <th class="px-6 py-4">Status</th>
              <th class="px-6 py-4 text-right">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-50">
            <tr
              *ngFor="let route of routes"
              class="hover:bg-gray-50 transition-colors duration-150"
            >
              <td
                class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"
              >
                #{{ route.id?.substring(0, 8) }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {{ route.routeDate | date : "short" }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <div
                    class="h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 text-xs shadow-sm"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-4 w-4"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"
                      />
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"
                      />
                    </svg>
                  </div>
                  <div class="ml-3">
                    <div class="text-sm font-medium text-gray-900">
                      {{ route.vehicule?.matricul || "N/A" }}
                    </div>
                    <div class="text-xs text-gray-500">
                      {{
                        route.vehicule?.vehiculeType === "camion"
                          ? "Truck"
                          : "Car"
                      }}
                    </div>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4">
                <div class="flex items-center">
                  <span class="text-sm text-gray-600">
                    {{ route.pickUpPoints?.length || 0 }} points
                  </span>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {{ route.totalDistance / 1000 | number : "1.1-1" }} km
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                  [ngClass]="{
                    'bg-blue-100 text-blue-800':
                      route.status?.toUpperCase() === 'PLANNED',
                    'bg-yellow-100 text-yellow-800':
                      route.status?.toUpperCase() === 'IN_PROGRESS',
                    'bg-green-100 text-green-800':
                      route.status?.toUpperCase() === 'COMPLETED',
                    'bg-red-100 text-red-800':
                      route.status?.toUpperCase() === 'CANCELLED',
                    'bg-gray-100 text-gray-800': !route.status
                  }"
                >
                  {{ route.status || "Unknown" }}
                </span>
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
              >
                <button
                  class="text-gray-400 hover:text-blue-600 transition-colors duration-200 mr-3"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                    />
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                    />
                  </svg>
                </button>
                <button
                  class="text-gray-400 hover:text-red-600 transition-colors duration-200"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                    />
                  </svg>
                </button>
              </td>
            </tr>
            <tr *ngIf="routes.length === 0" class="bg-white">
              <td colspan="7" class="px-6 py-12 text-center text-gray-500">
                No routes found.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>
</div>
