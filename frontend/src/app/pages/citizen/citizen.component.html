<div class="citizen-container">
  <!-- Header -->
  <div class="citizen-header">
    <div class="header-content">
      <h1>ğŸ  Espace Citoyen</h1>
      <p>Suivez la collecte des dÃ©chets dans votre quartier</p>
    </div>
  </div>

  <!-- Loading State -->
  @if (isLoading) {
  <div class="loading-container">
    <div class="spinner"></div>
    <p>Chargement des donnÃ©es...</p>
  </div>
  }

  <!-- Error State -->
  @if (errorMessage && !isLoading) {
  <div class="error-container">
    <p class="error-message">{{ errorMessage }}</p>
    <button class="btn-retry" (click)="loadData()">RÃ©essayer</button>
  </div>
  }

  <!-- Main Content -->
  @if (!isLoading && !errorMessage) {
  <div class="citizen-content">
    <!-- Quick Stats -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">ğŸ“</div>
        <div class="stat-info">
          <h3>{{ pickuppoints.length }}</h3>
          <p>Points de collecte</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">ğŸ—‘ï¸</div>
        <div class="stat-info">
          <h3>{{ containers.length }}</h3>
          <p>Conteneurs disponibles</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">ğŸš›</div>
        <div class="stat-info">
          <h3>{{ upcomingRoutes.length }}</h3>
          <p>Prochaines collectes</p>
        </div>
      </div>
    </div>

    <!-- Pickup Points Section -->
    <div class="section-card">
      <div class="section-header">
        <h2>ğŸ“ Points de Collecte Proches</h2>
      </div>

      @if (pickuppoints.length > 0) {
      <div class="pickup-points-grid">
        @for (point of pickuppoints; track point.id) {
        <div class="pickup-point-card">
          <div class="point-header">
            <div class="point-icon">ğŸ“</div>
            <div class="point-info">
              <h3>Point de Collecte #{{ point.id?.substring(0, 8) }}</h3>
              <p class="point-address">
                ğŸ“ {{ point.locationLatitude }}, {{ point.locationLongitude }}
              </p>
            </div>
          </div>

          <div class="point-containers">
            <h4>Conteneurs disponibles :</h4>
            @if (point.containers && point.containers.length > 0) {
            <div class="containers-list">
              @for (container of point.containers; track container.id) {
              <div
                class="container-tag"
                [class]="getContainerStatusClass(container.containerStatus)"
              >
                <span class="container-icon">{{
                  getContainerTypeIcon(container.containerType)
                }}</span>
                <span class="container-type">{{ container.containerType }}</span>
                <span class="container-status">{{
                  container.containerStatus
                }}</span>
              </div>
              }
            </div>
            } @else {
            <p class="no-containers">Aucun conteneur disponible</p>
            }
          </div>
        </div>
        }
      </div>
      } @else {
      <div class="empty-state">
        <p>Aucun point de collecte disponible</p>
      </div>
      }
    </div>

    <!-- Upcoming Routes Section -->
    <div class="section-card">
      <div class="section-header">
        <h2>ğŸš› Prochaines Collectes</h2>
      </div>

      @if (upcomingRoutes.length > 0) {
      <div class="routes-list">
        @for (route of upcomingRoutes; track route.id) {
        <div class="route-card">
          <div class="route-icon">ğŸš›</div>
          <div class="route-info">
            <h3>
              Collecte du {{ route.routeDate | date : "fullDate" : "" : "fr" }}
            </h3>
            <div class="route-details">
              @if (route.startTime) {
              <span class="route-time">â° DÃ©but: {{ route.startTime }}</span>
              } @if (route.endTime) {
              <span class="route-time">â° Fin: {{ route.endTime }}</span>
              } @if (route.status) {
              <span class="route-status">ğŸ“Š {{ route.status }}</span>
              }
            </div>
          </div>
        </div>
        }
      </div>
      } @else {
      <div class="empty-state">
        <p>Aucune collecte programmÃ©e</p>
      </div>
      }
    </div>

    <!-- Information Section -->
    <div class="info-section">
      <div class="info-card">
        <h3>â„¹ï¸ Informations Importantes</h3>
        <ul>
          <li>Les collectes ont lieu selon le calendrier affichÃ© ci-dessus</li>
          <li>
            Veuillez trier vos dÃ©chets selon les types de conteneurs disponibles
          </li>
          <li>Les conteneurs pleins sont collectÃ©s en prioritÃ©</li>
          <li>Pour toute question, contactez le service municipal</li>
        </ul>
      </div>

      <div class="info-card">
        <h3>â™»ï¸ Guide de Tri</h3>
        <div class="sorting-guide">
          <div class="sort-item">
            <span class="sort-icon">ğŸ“¦</span>
            <span class="sort-text"
              ><strong>Carton:</strong> BoÃ®tes, emballages</span
            >
          </div>
          <div class="sort-item">
            <span class="sort-icon">â™»ï¸</span>
            <span class="sort-text"
              ><strong>Plastique:</strong> Bouteilles, sacs</span
            >
          </div>
        </div>
      </div>
    </div>
  </div>
  }
</div>
